<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <title>Player de Inglês</title>
  <style>
    body, html { 
      margin: 0; padding: 0; width: 100%; height: 100%; 
      background-color: #121212; color: #fff; font-family: -apple-system, sans-serif;
      overflow: hidden; touch-action: none; 
    }
    .top-bar {
      padding: 15px; background: #1e1e1e; display: flex; flex-direction: column; gap: 10px;
      position: relative; z-index: 20;
    }
    input {
      padding: 10px; border-radius: 8px; border: none; background: #2a2a2a; color: white;
      font-size: 14px; width: box-sizing: border-box;
    }
    button {
      padding: 10px; border-radius: 8px; border: none; background: #007aff; color: white;
      font-size: 16px; font-weight: bold; cursor: pointer;
    }
    #video-container {
      position: relative; width: 100%; height: 35vh; margin-top: 5vh;
    }
    #player { width: 100%; height: 100%; pointer-events: none; }
    
    #swipe-zone {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10;
    }
    .instrucoes { text-align: center; padding: 20px; font-size: 14px; color: #aaa; }
  </style>
</head>
<body>

  <div class="top-bar">
    <input type="password" id="api-key" placeholder="Cole sua Chave API do YouTube aqui">
    <input type="text" id="search-query" placeholder="Pesquisar vídeo (ex: Solar Inverters)">
    <button onclick="buscarVideo()">Pesquisar</button>
  </div>

  <div id="video-container">
    <div id="swipe-zone"></div>
    <div id="player"></div>
  </div>

  <div class="instrucoes">
    Toque no centro para Pausar/Play<br><br>
    ⬅️ Deslize Esq: Voltar 5s | Deslize Dir: Avançar 5s ➡️
  </div>

  <script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var player;
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '100%',
        width: '100%',
        videoId: '', // Inicia vazio
        playerVars: {
          'playsinline': 1,
          'cc_load_policy': 1, 
          'controls': 0, 
          'disablekb': 1,
          'rel': 0
        }
      });
    }

    // Função de Busca usando a API do YouTube
    async function buscarVideo() {
      const apiKey = document.getElementById('api-key').value;
      const query = document.getElementById('search-query').value;

      if (!apiKey || !query) {
        alert("Preencha a Chave API e a pesquisa!");
        return;
      }

      const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=1&q=${encodeURIComponent(query)}&type=video&key=${apiKey}`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.items && data.items.length > 0) {
          const videoId = data.items[0].id.videoId;
          player.loadVideoById(videoId);
        } else {
          alert("Nenhum vídeo encontrado ou Chave API inválida.");
        }
      } catch (error) {
        alert("Erro ao buscar o vídeo. Verifique sua conexão e a Chave API.");
      }
    }

    // Lógica de Gestos
    let touchStartX = 0;
    let touchEndX = 0;
    const swipeZone = document.getElementById('swipe-zone');

    swipeZone.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; });
    swipeZone.addEventListener('touchend', e => { touchEndX = e.changedTouches[0].screenX; handleSwipe(); });

    function handleSwipe() {
      const minSwipeDistance = 50; 
      if (touchEndX < touchStartX - minSwipeDistance && player && player.getCurrentTime) {
        player.seekTo(player.getCurrentTime() - 5, true);
      }
      if (touchEndX > touchStartX + minSwipeDistance && player && player.getCurrentTime) {
        player.seekTo(player.getCurrentTime() + 5, true);
      }
      if (Math.abs(touchEndX - touchStartX) < 10) {
        if (player.getPlayerState() === YT.PlayerState.PLAYING) player.pauseVideo();
        else player.playVideo();
      }
    }
  </script>
</body>
</html>